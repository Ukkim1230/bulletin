<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ì£¼ì‚¬ë‘êµíšŒ ì²­ë…„ë¶€ ì£¼ë³´</title>
    
    <!-- PWA ë©”íƒ€ íƒœê·¸ -->
    <meta name="description" content="ì£¼ì‚¬ë‘êµíšŒ ì²­ë…„ë¶€ë¥¼ ìœ„í•œ ëª¨ë°”ì¼ ì£¼ë³´ ì•±">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="ì²­ë…„ë¶€ ì£¼ë³´">
    
    <!-- ë§¤ë‹ˆí˜ìŠ¤íŠ¸ -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- íŒŒë¹„ì½˜ (ê¸°ë³¸ ë¸Œë¼ìš°ì € ì•„ì´ì½˜ ì‚¬ìš©) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- ê³µí†µ ìŠ¤íƒ€ì¼ -->
    <th:block th:replace="~{fragments/styles :: styles}"></th:block>
    <th:block th:replace="~{fragments/bulletin-viewer :: bulletin-styles}"></th:block>

    <script>
        // QR ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜
        function openQRModal() {
            document.getElementById('qrModal').style.display = 'flex';
        }

        function closeQRModal() {
            document.getElementById('qrModal').style.display = 'none';
        }

        function shareQRCode() {
            // í˜„ì¬ í˜ì´ì§€ URL ì‚¬ìš©
            const url = window.location.origin;
            console.log('ê³µìœ í•  URL:', url);
            
            if (navigator.share) {
                navigator.share({
                    title: 'ì£¼ì‚¬ë‘êµíšŒ ì²­ë…„ë¶€ ì£¼ë³´',
                    text: 'ì£¼ì‚¬ë‘êµíšŒ ì²­ë…„ë¶€ ë””ì§€í„¸ ì£¼ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”!',
                    url: url
                })
                .then(() => {
                    console.log('ê³µìœ  ì„±ê³µ');
                    alert('ê³µìœ ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');
                })
                .catch((error) => {
                    console.log('ê³µìœ  ì‹¤íŒ¨:', error);
                    // ê³µìœ  ì‹¤íŒ¨ ì‹œ í´ë¦½ë³´ë“œ ë³µì‚¬ë¡œ ëŒ€ì²´
                    copyToClipboard(url);
                });
            } else {
                // ê³µìœ  APIê°€ ì§€ì›ë˜ì§€ ì•ŠëŠ” ê²½ìš° URL ë³µì‚¬
                copyToClipboard(url);
            }
        }
        
        function copyToClipboard(text) {
            if (navigator.clipboard && window.isSecureContext) {
                // HTTPS í™˜ê²½ì—ì„œ í´ë¦½ë³´ë“œ API ì‚¬ìš©
                navigator.clipboard.writeText(text)
                    .then(() => {
                        alert('ì£¼ì†Œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                    })
                    .catch(err => {
                        console.error('í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:', err);
                        fallbackCopyTextToClipboard(text);
                    });
            } else {
                // HTTP í™˜ê²½ì—ì„œ fallback ë°©ë²• ì‚¬ìš©
                fallbackCopyTextToClipboard(text);
            }
        }
        
        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = "fixed";
            textArea.style.left = "-999999px";
            textArea.style.top = "-999999px";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    alert('ì£¼ì†Œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                } else {
                    alert('ì£¼ì†Œ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì§ì ‘ ë³µì‚¬í•´ì£¼ì„¸ìš”: ' + text);
                }
            } catch (err) {
                console.error('Fallback ë³µì‚¬ ì‹¤íŒ¨:', err);
                alert('ì£¼ì†Œ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì§ì ‘ ë³µì‚¬í•´ì£¼ì„¸ìš”: ' + text);
            }
            document.body.removeChild(textArea);
        }

        // ëª¨ë‹¬ ì˜¤ë²„ë ˆì´ í´ë¦­ìœ¼ë¡œ ë‹«ê¸°
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('qrModal');
            if (event.target === modal) {
                closeQRModal();
            }
        });

        // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const modal = document.getElementById('qrModal');
                if (modal.style.display === 'flex') {
                    closeQRModal();
                }
            }
        });
    </script>
</head>
<body>
    <!-- í—¤ë” -->
    <th:block th:replace="~{fragments/header :: header(${currentDate})}"></th:block>

    <!-- ë©”ì¸ ì»¨í…ì¸  ì˜ì—­ -->
    <main id="mainContent" class="container-fluid px-3 py-3 pb-5">
        <!-- í™ˆ íƒ­ ì»¨í…ì¸  -->
        <div id="homeTab" class="tab-content">
            <!-- êµíšŒ ì •ë³´ -->
            <th:block th:replace="~{fragments/church-info :: church-info}"></th:block>

            <!-- ì£¼ë³´ ë³´ê¸° ë²„íŠ¼ -->
            <section class="mb-4">
                <button onclick="openBulletinViewer()" class="btn btn-primary w-100 py-3 d-flex align-items-center justify-content-center gap-2" style="font-size: 1.125rem; font-weight: 600; border-radius: 12px; background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%); border: none;">
                    <i class="fas fa-book-open"></i>
                    <span>ì£¼ë³´ ë³´ê¸°</span>
                </button>
            </section>

        <!-- ì²­ë…„ë¶€ ì˜ˆë°° ì¼ì • -->
        <section id="schedule" class="p-4" style="background: var(--muted); background-opacity: 0.3;">
            <button onclick="toggleSection('scheduleContent')" class="w-100 mb-4 d-flex align-items-center justify-content-between group" style="background: none; border: none; padding: 0;">
                <div class="text-start">
                    <h2 class="h5 fw-bold mb-1 group-hover" style="color: var(--foreground); transition: color 0.2s;">ì²­ë…„ë¶€ ì˜ˆë°° ì¼ì •</h2>
                    <p style="font-size: 0.875rem; color: var(--muted-foreground);">ì£¼ì°¨ë³„ë¡œ ë‹¤ì–‘í•œ í˜•íƒœì˜ ì˜ˆë°°ì™€ ëª¨ì„ì„ ì§„í–‰í•´ìš”</p>
                </div>
                <i class="fas fa-chevron-down" id="scheduleIcon" style="color: var(--muted-foreground); transition: transform 0.3s;"></i>
            </button>
            
            <div id="scheduleContent" class="accordion-content" style="max-height: 0; overflow: hidden; opacity: 0; transition: all 0.5s ease-in-out;">

            <div class="d-flex flex-column gap-3">
                <!-- 1ì£¼ì°¨: ì²­ë…„ì£¼ê´€ ì˜¤í›„ì˜ˆë°° -->
                <div class="card" style="border: 1px solid var(--border); border-opacity: 0.5; background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);">
                    <div class="card-body p-4">
                        <div class="d-flex align-items-center justify-content-between">
                            <div class="flex-grow-1">
                                <div class="d-flex align-items-center gap-2 mb-2">
                                    <h3 class="fw-semibold mb-0" style="color: white;">1ì£¼ì°¨: ì²­ë…„ì£¼ê´€ ì˜¤í›„ì˜ˆë°°</h3>
                                    <span class="badge px-2 py-1 rounded-pill" style="font-size: 0.75rem; background: rgba(255,255,255,0.2); color: white;">ë§¤ì›” ì²«ì§¸ì£¼</span>
                                </div>
                                <div class="d-flex flex-column gap-1">
                                    <div class="d-flex align-items-center gap-2" style="font-size: 0.875rem; color: rgba(255,255,255,0.9);">
                                        <i class="fas fa-clock" style="width: 1rem; height: 1rem;"></i>
                                        <span>ì˜¤í›„ 2:00</span>
                                    </div>
                                    <div class="d-flex align-items-center gap-2" style="font-size: 0.875rem; color: rgba(255,255,255,0.9);">
                                        <i class="fas fa-map-marker-alt" style="width: 1rem; height: 1rem;"></i>
                                        <span>2ì¸µ ì˜ˆë°°ë‹¹</span>
                                    </div>
                                </div>
                            </div>
                            <div class="text-end">
                                <i class="fas fa-users" style="font-size: 2rem; color: rgba(255,255,255,0.3);"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 2ì£¼ì°¨: ì²­ë…„ë¶€ ìì²´ ì˜ˆë°° -->
                <div class="card" style="border: 1px solid var(--border); border-opacity: 0.5;">
                    <div class="card-body p-4">
                        <div class="d-flex align-items-center justify-content-between">
                            <div class="flex-grow-1">
                                <div class="d-flex align-items-center gap-2 mb-2">
                                    <h3 class="fw-semibold mb-0" style="color: var(--foreground);">2ì£¼ì°¨: ì²­ë…„ë¶€ ìì²´ ì˜ˆë°°</h3>
                                    <span class="badge px-2 py-1 rounded-pill" style="font-size: 0.75rem; background: var(--secondary); background-opacity: 0.8; color: var(--secondary-foreground);">ë§¤ì›” ë‘˜ì§¸ì£¼</span>
                                </div>
                                <div class="d-flex flex-column gap-1">
                                    <div class="d-flex align-items-center gap-2" style="font-size: 0.875rem; color: var(--muted-foreground);">
                                        <i class="fas fa-clock" style="width: 1rem; height: 1rem;"></i>
                                        <span>ì˜¤í›„ 1:00</span>
                                    </div>
                                    <div class="d-flex align-items-center gap-2" style="font-size: 0.875rem; color: var(--muted-foreground);">
                                        <i class="fas fa-map-marker-alt" style="width: 1rem; height: 1rem;"></i>
                                        <span>ì§€í•˜1ì¸µ ì¤‘ê³ ë“±ë¶€ì‹¤</span>
                                    </div>
                                </div>
                            </div>
                            <div class="text-end">
                                <p class="mb-0" style="font-size: 0.875rem; color: var(--muted-foreground);">ì˜ˆë°°</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 3ì£¼ì°¨: ì²­ë…„ë¶€ ìì²´ ì˜ˆë°° -->
                <div class="card" style="border: 1px solid var(--border); border-opacity: 0.5;">
                    <div class="card-body p-4">
                        <div class="d-flex align-items-center justify-content-between">
                            <div class="flex-grow-1">
                                <div class="d-flex align-items-center gap-2 mb-2">
                                    <h3 class="fw-semibold mb-0" style="color: var(--foreground);">3ì£¼ì°¨: ì²­ë…„ë¶€ ìì²´ ì˜ˆë°°</h3>
                                    <span class="badge px-2 py-1 rounded-pill" style="font-size: 0.75rem; background: var(--secondary); background-opacity: 0.8; color: var(--secondary-foreground);">ë§¤ì›” ì…‹ì§¸ì£¼</span>
                                </div>
                                <div class="d-flex flex-column gap-1">
                                    <div class="d-flex align-items-center gap-2" style="font-size: 0.875rem; color: var(--muted-foreground);">
                                        <i class="fas fa-clock" style="width: 1rem; height: 1rem;"></i>
                                        <span>ì˜¤í›„ 1:00</span>
                                    </div>
                                    <div class="d-flex align-items-center gap-2" style="font-size: 0.875rem; color: var(--muted-foreground);">
                                        <i class="fas fa-map-marker-alt" style="width: 1rem; height: 1rem;"></i>
                                        <span>ì§€í•˜1ì¸µ ì¤‘ê³ ë“±ë¶€ì‹¤</span>
                                    </div>
                                </div>
                            </div>
                            <div class="text-end">
                                <p class="mb-0" style="font-size: 0.875rem; color: var(--muted-foreground);">ì˜ˆë°°</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 4ì£¼ì°¨: ì²­ë…„ë¶€ ìì²´ ê¸°ë„íšŒ -->
                <div class="card" style="border: 1px solid var(--border); border-opacity: 0.5; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);">
                    <div class="card-body p-4">
                        <div class="d-flex align-items-center justify-content-between">
                            <div class="flex-grow-1">
                                <div class="d-flex align-items-center gap-2 mb-2">
                                    <h3 class="fw-semibold mb-0" style="color: white;">4ì£¼ì°¨: ì²­ë…„ë¶€ ìì²´ ê¸°ë„íšŒ</h3>
                                    <span class="badge px-2 py-1 rounded-pill" style="font-size: 0.75rem; background: rgba(255,255,255,0.2); color: white;">ë§¤ì›” ë„·ì§¸ì£¼</span>
                                </div>
                                <div class="d-flex flex-column gap-1">
                                    <div class="d-flex align-items-center gap-2" style="font-size: 0.875rem; color: rgba(255,255,255,0.9);">
                                        <i class="fas fa-clock" style="width: 1rem; height: 1rem;"></i>
                                        <span>ì˜¤í›„ 1:00</span>
                                    </div>
                                    <div class="d-flex align-items-center gap-2" style="font-size: 0.875rem; color: rgba(255,255,255,0.9);">
                                        <i class="fas fa-map-marker-alt" style="width: 1rem; height: 1rem;"></i>
                                        <span>ì§€í•˜1ì¸µ ì¤‘ê³ ë“±ë¶€ì‹¤</span>
                                    </div>
                                </div>
                            </div>
                            <div class="text-end">
                                <i class="fas fa-church" style="font-size: 2rem; color: rgba(255,255,255,0.3);"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 5ì£¼ì°¨: ì• ì°¬ëª¨ì„ -->
                <div class="card" style="border: 1px solid var(--border); border-opacity: 0.5; background: linear-gradient(135deg, #f59e0b 0%, #f97316 100%);">
                    <div class="card-body p-4">
                        <div class="d-flex align-items-center justify-content-between">
                            <div class="flex-grow-1">
                                <div class="d-flex align-items-center gap-2 mb-2">
                                    <h3 class="fw-semibold mb-0" style="color: white;">5ì£¼ì°¨: ì• ì°¬ëª¨ì„</h3>
                                    <span class="badge px-2 py-1 rounded-pill" style="font-size: 0.75rem; background: rgba(255,255,255,0.2); color: white;">5ì£¼ì°¨ê°€ ìˆëŠ” ë‹¬</span>
                                </div>
                                <div class="d-flex flex-column gap-1">
                                    <div class="d-flex align-items-center gap-2" style="font-size: 0.875rem; color: rgba(255,255,255,0.9);">
                                        <i class="fas fa-clock" style="width: 1rem; height: 1rem;"></i>
                                        <span>ì˜¤í›„ 1:00</span>
                                    </div>
                                    <div class="d-flex align-items-center gap-2" style="font-size: 0.875rem; color: rgba(255,255,255,0.9);">
                                        <i class="fas fa-utensils" style="width: 1rem; height: 1rem;"></i>
                                        <span>ê³µì§€ í™•ì¸</span>
                                    </div>
                                </div>
                            </div>
                            <div class="text-end">
                                <i class="fas fa-heart" style="font-size: 2rem; color: rgba(255,255,255,0.3);"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì•ˆë‚´ ë©”ì‹œì§€ -->
            <div class="mt-4 p-3 rounded-3" style="background: var(--accent); background-opacity: 0.5;">
                <div class="d-flex align-items-start gap-3">
                    <i class="fas fa-info-circle" style="color: var(--primary); margin-top: 0.125rem;"></i>
                    <div>
                        <p class="fw-medium mb-1" style="color: var(--foreground); font-size: 0.875rem;">ğŸ“… ì£¼ì°¨ë³„ ì˜ˆë°° ì•ˆë‚´</p>
                        <p class="mb-0" style="color: var(--muted-foreground); font-size: 0.75rem; line-height: 1.4;">
                            ë§¤ì›” ì£¼ì°¨ì— ë”°ë¼ ë‹¤ë¥¸ í˜•íƒœì˜ ì˜ˆë°°ì™€ ëª¨ì„ì„ ì§„í–‰í•©ë‹ˆë‹¤. ìì„¸í•œ ì¼ì •ì€ ì²­ë…„ë¶€ ë‹¨ì²´ ì±„íŒ…ë°©ì„ í™•ì¸í•´ì£¼ì„¸ìš”!
                        </p>
                    </div>
                </div>
            </div>
            </div>
        </section>

        <!-- ì„±ê²½êµ¬ì ˆ -->
        <section class="p-4 mb-3" th:if="${not #lists.isEmpty(bulletin.bibleVerses)}" style="background: var(--muted); background-opacity: 0.3;">
            <button onclick="toggleSection('bibleContent')" class="w-100 mb-4 d-flex align-items-center justify-content-between group" style="background: none; border: none; padding: 0;">
                <div class="text-start">
                    <h2 class="h5 fw-bold mb-1 group-hover" style="color: var(--foreground); transition: color 0.2s;">ì„±ê²½êµ¬ì ˆ</h2>
                    <p style="font-size: 0.875rem; color: var(--muted-foreground);">í•˜ë‚˜ë‹˜ì˜ ë§ì”€ì„ í•¨ê»˜ ë‚˜ëˆ ìš”</p>
                </div>
                <i class="fas fa-chevron-down" id="bibleIcon" style="color: var(--muted-foreground); transition: transform 0.3s;"></i>
            </button>
            
            <div id="bibleContent" class="accordion-content" style="max-height: 0; overflow: hidden; opacity: 0; transition: all 0.5s ease-in-out;">
                <div th:each="verse : ${bulletin.bibleVerses}">
                    <div class="card mb-3" style="border: 1px solid var(--border); border-opacity: 0.5;">
                        <div class="card-body p-4">
                            <h6 class="mb-2">
                                <i class="fas fa-bible me-2" style="color: var(--primary);"></i>
                                <span th:text="${verse.verseReference}" style="color: var(--foreground);">ìš”í•œë³µìŒ 3:16</span>
                            </h6>
                            <p class="mb-0" th:text="${verse.verseText}" style="color: var(--muted-foreground); line-height: 1.6;">í•˜ë‚˜ë‹˜ì´ ì„¸ìƒì„ ì´ì²˜ëŸ¼ ì‚¬ë‘í•˜ì‚¬...</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- êµíšŒ ì†Œì‹ (Announcements) -->
        <section class="p-4">
            <button onclick="toggleSection('announcementsContent')" class="w-100 mb-4 d-flex align-items-center justify-content-between group" style="background: none; border: none; padding: 0;">
                <div class="text-start">
                    <h2 class="h5 fw-bold mb-1 group-hover" style="color: var(--foreground); transition: color 0.2s;">êµíšŒ ì†Œì‹</h2>
                    <p style="font-size: 0.875rem; color: var(--muted-foreground);">êµíšŒì˜ ì¤‘ìš”í•œ ì†Œì‹ë“¤ì„ í™•ì¸í•˜ì„¸ìš”</p>
                </div>
                <i class="fas fa-chevron-down" id="announcementsIcon" style="color: var(--muted-foreground); transition: transform 0.3s;"></i>
            </button>
            
            <div id="announcementsContent" class="accordion-content" style="max-height: 0; overflow: hidden; opacity: 0; transition: all 0.5s ease-in-out;">
                <!-- ì†Œì‹ ì¶”ê°€ ë²„íŠ¼ -->
                <div class="mb-4">
                    <button onclick="openAddAnnouncementDialog()" class="btn btn-outline-primary w-100 d-flex align-items-center justify-content-center gap-2" style="border: 2px dashed var(--border); background: transparent; color: var(--primary); padding: 1rem;">
                        <i class="fas fa-plus"></i>
                        <span>ì†Œì‹ ì¶”ê°€</span>
                    </button>
                </div>

            <div class="d-flex flex-column gap-3" th:if="${not #lists.isEmpty(bulletin.announcements)}">
                <div class="card border-0 shadow-sm" 
                     style="border: 1px solid var(--border); border-opacity: 0.5; transition: box-shadow 0.2s ease; cursor: pointer;"
                     onmouseover="this.style.boxShadow='0 4px 6px -1px rgba(0, 0, 0, 0.1)'; this.style.transform='scale(1.02)'"
                     onmouseout="this.style.boxShadow='0 1px 3px 0 rgba(0, 0, 0, 0.1)'; this.style.transform='scale(1)'"
                     th:onclick="'viewAnnouncement(' + ${announcement.id} + ')'"
                     th:data-id="${announcement.id}"
                     th:each="announcement : ${bulletin.announcements}">
                    <div class="card-body p-4">
                        <div class="d-flex align-items-start gap-3">
                            <!-- ì•„ì´ì½˜ -->
                            <div class="flex-shrink-0 d-flex align-items-center justify-content-center rounded-2"
                                 style="width: 40px; height: 40px; background: var(--primary); background-opacity: 0.1;">
                                <i class="fas fa-heart" style="color: var(--primary); font-size: 1.25rem;"></i>
                            </div>

                            <!-- ë‚´ìš© -->
                            <div class="flex-grow-1 min-width-0">
                                <div class="d-flex align-items-center gap-2 mb-1">
                                    <h3 class="fw-semibold mb-0" style="font-size: 0.875rem; color: var(--foreground);" th:text="${announcement.title}">ìƒˆê°€ì¡± í™˜ì˜ì‹</h3>
                                    <span class="badge text-white px-2 py-0" 
                                          style="font-size: 0.75rem; background: var(--destructive);" 
                                          th:if="${announcement.isImportant}">ì¤‘ìš”</span>
                                    <span class="badge px-2 py-0" 
                                          style="font-size: 0.75rem; background: var(--secondary); color: var(--secondary-foreground);">í–‰ì‚¬</span>
                                </div>

                                <p class="mb-2" style="font-size: 0.875rem; color: var(--muted-foreground); line-height: 1.5;" 
                                   th:text="${announcement.content}">3ì›” 26ì¼(ì¼) ì˜¤í›„ 2ì‹œ ìƒˆê°€ì¡±ì„ ìœ„í•œ í™˜ì˜ì‹ì´ ìˆìŠµë‹ˆë‹¤. ë§ì€ ì°¸ì—¬ ë¶€íƒë“œë¦½ë‹ˆë‹¤.</p>

                                <p class="mb-0" style="font-size: 0.75rem; color: var(--muted-foreground);" 
                                   th:text="${#temporals.format(announcement.announcementDate, 'yyyy.MM.dd')}">2024.03.19</p>
                            </div>
                            
                            <!-- í¸ì§‘/ì‚­ì œ ë²„íŠ¼ -->
                            <div class="d-flex gap-1" onclick="event.stopPropagation()">
                                <button th:onclick="'openEditAnnouncementDialog(' + ${announcement.id} + ')'" 
                                        th:data-id="${announcement.id}"
                                        class="btn btn-sm btn-outline-secondary" 
                                        style="width: 32px; height: 32px; padding: 0; display: flex; align-items: center; justify-content: center;">
                                    <i class="fas fa-edit" style="font-size: 0.75rem;"></i>
                                </button>
                                <button th:onclick="'deleteAnnouncement(' + ${announcement.id} + ')'" 
                                        th:data-id="${announcement.id}"
                                        class="btn btn-sm btn-outline-danger" 
                                        style="width: 32px; height: 32px; padding: 0; display: flex; align-items: center; justify-content: center;">
                                    <i class="fas fa-trash" style="font-size: 0.75rem;"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div>
        </section>

        <!-- ì—°ë½ì²˜ & ì˜¤ì‹œëŠ” ê¸¸ (Contact) -->
        <section class="p-4" style="background: var(--muted); background-opacity: 0.3;">
            <button onclick="toggleSection('contactContent')" class="w-100 mb-4 d-flex align-items-center justify-content-between group" style="background: none; border: none; padding: 0;">
                <div class="text-start">
                    <h2 class="h5 fw-bold mb-1 group-hover" style="color: var(--foreground); transition: color 0.2s;">ì—°ë½ì²˜ & ì˜¤ì‹œëŠ” ê¸¸</h2>
                    <p style="font-size: 0.875rem; color: var(--muted-foreground);">êµíšŒ ì •ë³´ì™€ ì°¾ì•„ì˜¤ëŠ” ë°©ë²•</p>
                </div>
                <i class="fas fa-chevron-down" id="contactIcon" style="color: var(--muted-foreground); transition: transform 0.3s;"></i>
            </button>
            
            <div id="contactContent" class="accordion-content" style="max-height: 0; overflow: hidden; opacity: 0; transition: all 0.5s ease-in-out;">

            <!-- ì—°ë½ì²˜ ì •ë³´ -->
            <div class="card mb-4" style="border: 1px solid var(--border); border-opacity: 0.5;">
                <div class="card-body p-4">
                    <h3 class="fw-semibold mb-3" style="color: var(--foreground);">ì—°ë½ì²˜ ì •ë³´</h3>
                    <div class="d-flex flex-column gap-3">
                        <!-- ì „í™”ë²ˆí˜¸ -->
                        <div class="d-flex align-items-center justify-content-between">
                            <div class="d-flex align-items-center gap-3">
                                <div class="d-flex align-items-center justify-content-center rounded-2" 
                                     style="width: 2rem; height: 2rem; background: var(--primary); background-opacity: 0.1;">
                                    <i class="fas fa-phone" style="font-size: 1rem; color: var(--primary);"></i>
                                </div>
                                <div>
                                    <p class="mb-0" style="font-size: 0.75rem; color: var(--muted-foreground);">ì „í™”ë²ˆí˜¸</p>
                                    <p class="mb-0 fw-medium" style="font-size: 0.875rem; color: var(--foreground);">010-5240-7719</p>
                                </div>
                            </div>
                            <a href="tel:02-1234-5678" class="btn btn-outline-primary btn-sm">ì—°ê²°</a>
                        </div>
                        <!-- ì£¼ì†Œ -->
                        <div class="d-flex align-items-center justify-content-between">
                            <div class="d-flex align-items-center gap-3">
                                <div class="d-flex align-items-center justify-content-center rounded-2" 
                                     style="width: 2rem; height: 2rem; background: var(--primary); background-opacity: 0.1;">
                                    <i class="fas fa-map-marker-alt" style="font-size: 1rem; color: var(--primary);"></i>
                                </div>
                                <div>
                                    <p class="mb-0" style="font-size: 0.75rem; color: var(--muted-foreground);">ì£¼ì†Œ</p>
                                    <p class="mb-0 fw-medium" style="font-size: 0.875rem; color: var(--foreground);">ê²½ê¸° í•˜ë‚¨ì‹œ ë”ìš°ê°œë¡œ 49</p>
                                </div>
                            </div>
                            <a href="https://map.naver.com/p/search/%ED%95%98%EB%82%A8%EC%A3%BC%EC%82%AC%EB%9E%91%EA%B5%90%ED%9A%8C/place/12980252?c=15.00,0,0,0,dh&placePath=/home?entry=pll&from=map&fromPanelNum=2&timestamp=202509231735&locale=ko&svcName=map_pcv5&searchText=%ED%95%98%EB%82%A8%EC%A3%BC%EC%82%AC%EB%9E%91%EA%B5%90%ED%9A%8C" target="_blank" class="btn btn-outline-primary btn-sm">ì§€ë„ë³´ê¸°</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- êµí†µí¸ -->
            <div class="card mb-4" style="border: 1px solid var(--border); border-opacity: 0.5;">
                <div class="card-body p-4">
                    <h3 class="fw-semibold mb-3" style="color: var(--foreground);">êµí†µí¸</h3>
                    <div class="d-flex flex-column gap-3">
                        <div class="d-flex align-items-center gap-3">
                            <div class="d-flex align-items-center justify-content-center rounded-2" 
                                 style="width: 2rem; height: 2rem; background: var(--secondary); background-opacity: 0.5;">
                                <i class="fas fa-subway" style="font-size: 1rem; color: var(--secondary-foreground);"></i>
                            </div>
                            <div>
                                <p class="fw-medium mb-0" style="font-size: 0.875rem; color: var(--foreground);">ì§€í•˜ì² </p>
                                <p class="mb-0" style="font-size: 0.75rem; color: var(--muted-foreground);">5í˜¸ì„  í•˜ë‚¨ì‹œì²­ì—­ 1ë²ˆ ì¶œêµ¬ ë²„ìŠ¤ ì´ìš©</p>
                            </div>
                        </div>
                        <div class="d-flex align-items-center gap-3">
                            <div class="d-flex align-items-center justify-content-center rounded-2" 
                                 style="width: 2rem; height: 2rem; background: var(--secondary); background-opacity: 0.5;">
                                <i class="fas fa-car" style="font-size: 1rem; color: var(--secondary-foreground);"></i>
                            </div>
                            <div>
                                <p class="fw-medium mb-0" style="font-size: 0.875rem; color: var(--foreground);">ì£¼ì°¨</p>
                                <p class="mb-0" style="font-size: 0.75rem; color: var(--muted-foreground);">êµíšŒ ì£¼ì°¨ì¥ ì´ìš© ê°€ëŠ¥</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- êµì—­ì ì—°ë½ì²˜ -->
            <div class="card mb-4" style="border: 1px solid var(--border); border-opacity: 0.5;">
                <div class="card-body p-4">
                    <h3 class="fw-semibold mb-3" style="color: var(--foreground);">êµì—­ì ì—°ë½ì²˜</h3>
                    <div class="d-flex flex-column gap-3">
                        <div class="d-flex align-items-center justify-content-between">
                            <div>
                                <p class="fw-medium mb-0" style="font-size: 0.875rem; color: var(--foreground);">ë°•ë°”ìš¸ ëª©ì‚¬</p>
                                <p class="mb-0" style="font-size: 0.75rem; color: var(--muted-foreground);">ì²­ë…„ë¶€ ë‹´ë‹¹ ëª©ì‚¬</p>
                            </div>
                            <a href="tel:02-1234-5679" class="btn btn-outline-primary btn-sm">ì—°ë½</a>
                        </div>
                        <div class="d-flex align-items-center justify-content-between">
                        </div>
                    </div>
                </div>
            </div>

            
            </div>
        </section>
        </div>

        <!-- ì£¼ë³´ íƒ­ ì»¨í…ì¸  -->
        <div id="bulletinTab" class="tab-content" style="display: none;">
            <!-- ì£¼ë³´ ë·°ì–´ ì»¨í…ì¸  -->
            <div class="text-center py-5">
                <h3>ì£¼ë³´ ë³´ê¸°</h3>
                <p>ì£¼ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”</p>
            </div>
        </div>

        <!-- ì¼ì • íƒ­ ì»¨í…ì¸  -->
        <div id="calendarTab" class="tab-content" style="display: none;">
            <div class="text-center py-5">
                <h3>ì¼ì •</h3>
                <p>êµíšŒ ì¼ì •ì„ í™•ì¸í•˜ì„¸ìš”</p>
            </div>
        </div>

        <!-- ì•…ë³´ íƒ­ ì»¨í…ì¸  -->
        <div id="musicTab" class="tab-content" style="display: none;">
            <div class="text-center py-5">
                <h3>ì•…ë³´</h3>
                <p>ì•…ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”</p>
                <a href="/sheet-music" class="btn btn-primary">ì•…ë³´ ë³´ëŸ¬ê°€ê¸°</a>
            </div>
        </div>

        <!-- ìˆœëª¨ì„ íƒ­ ì»¨í…ì¸  -->
        <div id="smallGroupsTab" class="tab-content" style="display: none; min-height: calc(100vh - 120px); padding-bottom: 80px;">
            <!-- ìˆœëª¨ì„ ì•ˆë‚´ -->
            <div class="alert alert-info mb-4" style="background: var(--accent); background-opacity: 0.3; border: 1px solid var(--border); border-opacity: 0.5;">
                <div class="d-flex align-items-start gap-3">
                    <div class="flex-shrink-0 d-flex align-items-center justify-content-center rounded-2" 
                         style="width: 2.5rem; height: 2.5rem; background: var(--primary); background-opacity: 0.1;">
                        <i class="fas fa-info-circle" style="color: var(--primary); font-size: 1.25rem;"></i>
                    </div>
                    <div class="flex-grow-1">
                        <h5 class="fw-semibold mb-2" style="color: var(--foreground);">ìˆœëª¨ì„ì´ë€?</h5>
                        <p class="mb-0" style="color: var(--muted-foreground); line-height: 1.5;">
                            ì²­ë…„ë“¤ì´ í•¨ê»˜ ëª¨ì—¬ ë§ì”€ì„ ë‚˜ëˆ„ê³  êµì œí•˜ëŠ” ì†Œê·¸ë£¹ ëª¨ì„ì…ë‹ˆë‹¤. 
                            ë§¤ì£¼ ì •ê¸°ì ìœ¼ë¡œ ë§Œë‚˜ ì„œë¡œë¥¼ ê²©ë ¤í•˜ê³  ì‹ ì•™ì„ ì„±ì¥ì‹œì¼œ ë‚˜ê°‘ë‹ˆë‹¤.
                        </p>
                    </div>
                </div>
            </div>

            <!-- ìˆœëª¨ì„ í—¤ë” -->
            <div class="d-flex align-items-center justify-content-between mb-4">
                <button onclick="switchTab('home')" class="btn btn-outline-secondary d-flex align-items-center gap-2" style="border: 1px solid var(--border); background: transparent; color: var(--foreground);">
                    <i class="fas fa-arrow-left"></i>
                    <span>ëŒì•„ê°€ê¸°</span>
                </button>
                <h3 class="mb-0" style="color: var(--foreground);">ìˆœëª¨ì„</h3>
                <button onclick="openAddSmallGroupDialog()" class="btn btn-primary btn-sm d-flex align-items-center gap-1">
                    <i class="fas fa-plus"></i>
                    <span>ì¶”ê°€</span>
                </button>
            </div>

            <!-- ìˆœëª¨ì„ ëª©ë¡ -->
            <div id="smallGroupsList" class="d-flex flex-column gap-3">
                <!-- ìˆœëª¨ì„ ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
            </div>

            <!-- ìˆœëª¨ì„ì´ ì—†ëŠ” ê²½ìš° -->
            <div id="noSmallGroups" class="text-center py-5" style="display: none;">
                <i class="fas fa-users fa-3x text-muted mb-3"></i>
                <h5 class="text-muted">ì•„ì§ ë“±ë¡ëœ ìˆœëª¨ì„ì´ ì—†ìŠµë‹ˆë‹¤</h5>
                <p class="text-muted">ì²« ë²ˆì§¸ ìˆœëª¨ì„ì„ ë“±ë¡í•´ë³´ì„¸ìš”!</p>
            </div>
        </div>

        <!-- ì—°ë½ì²˜ íƒ­ ì»¨í…ì¸  -->
        <div id="contactTab" class="tab-content" style="display: none;">
            <div class="text-center py-5">
                <h3>ì—°ë½ì²˜ & ì˜¤ì‹œëŠ” ê¸¸</h3>
                <p>êµíšŒ ì—°ë½ì²˜ì™€ ìœ„ì¹˜ë¥¼ í™•ì¸í•˜ì„¸ìš”</p>
            </div>
        </div>
    </main>

    <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ë° ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ -->
    <th:block th:replace="~{fragments/bottom-nav :: bottom-nav}"></th:block>
    <th:block th:replace="~{fragments/bottom-nav :: refresh-btn}"></th:block>

    <!-- ì£¼ë³´ ë·°ì–´ -->
    <th:block th:replace="~{fragments/bulletin-viewer :: bulletin-viewer}"></th:block>
    <th:block th:replace="~{fragments/bulletin-viewer :: bulletin-modals}"></th:block>

    <!-- ì†Œì‹ ìƒì„¸ë³´ê¸° ëª¨ë‹¬ -->
    <div id="announcementViewDialog" class="edit-dialog" style="display: none;">
        <div class="edit-dialog-overlay" onclick="closeAnnouncementViewDialog()"></div>
        <div class="edit-dialog-content">
            <div class="edit-dialog-header">
                <div class="d-flex align-items-start gap-3">
                    <div class="flex-shrink-0 d-flex align-items-center justify-content-center rounded-2" 
                         style="width: 3.5rem; height: 3.5rem; background: var(--primary); background-opacity: 0.1;">
                        <i id="viewAnnouncementIcon" class="fas fa-heart" style="color: var(--primary); font-size: 1.75rem;"></i>
                    </div>
                    <div class="flex-grow-1">
                        <h3 class="edit-dialog-title mb-2" id="viewAnnouncementTitle">ìƒˆê°€ì¡± í™˜ì˜ì‹</h3>
                        <div class="d-flex align-items-center gap-2">
                            <span id="viewAnnouncementImportant" class="badge text-white px-2 py-1" 
                                  style="font-size: 0.75rem; background: var(--destructive); display: none;">ì¤‘ìš”</span>
                            <span id="viewAnnouncementCategory" class="badge px-2 py-1" 
                                  style="font-size: 0.75rem; background: var(--secondary); color: var(--secondary-foreground);">í–‰ì‚¬</span>
                            <span id="viewAnnouncementDate" class="text-muted" style="font-size: 0.75rem;">2024.03.19</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="edit-dialog-body">
                <p id="viewAnnouncementContent" class="mb-0" style="color: var(--foreground); line-height: 1.6; white-space: pre-wrap;">
                    3ì›” 26ì¼(ì¼) ì˜¤í›„ 2ì‹œ ìƒˆê°€ì¡±ì„ ìœ„í•œ í™˜ì˜ì‹ì´ ìˆìŠµë‹ˆë‹¤. ë§ì€ ì°¸ì—¬ ë¶€íƒë“œë¦½ë‹ˆë‹¤.
                </p>
            </div>
            
            <div class="edit-dialog-footer">
                <button class="btn btn-outline w-100" onclick="closeAnnouncementViewDialog()">ë‹«ê¸°</button>
            </div>
        </div>
    </div>

    <!-- ì†Œì‹ ì¶”ê°€/í¸ì§‘ ëª¨ë‹¬ -->
    <div id="announcementDialog" class="edit-dialog" style="display: none;">
        <div class="edit-dialog-overlay" onclick="closeAnnouncementDialog()"></div>
        <div class="edit-dialog-content">
            <div class="edit-dialog-header">
                <h3 class="edit-dialog-title" id="announcementDialogTitle">ì†Œì‹ ì¶”ê°€</h3>
                <p class="edit-dialog-description">êµíšŒ ì†Œì‹ì„ ì¶”ê°€í•˜ê±°ë‚˜ ìˆ˜ì •í•©ë‹ˆë‹¤.</p>
            </div>
            
            <div class="edit-dialog-body">
                <div class="form-group">
                    <label for="announcementTitle" class="form-label">ì œëª©</label>
                    <input type="text" id="announcementTitle" class="form-input" placeholder="ì†Œì‹ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" required>
                </div>
                
                <div class="form-group">
                    <label for="announcementContent" class="form-label">ë‚´ìš©</label>
                    <textarea id="announcementContent" class="form-input" placeholder="ì†Œì‹ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”" rows="4" required></textarea>
                </div>
                
                <div class="row">
                    <div class="col-6">
                        <div class="form-group">
                            <label for="announcementCategory" class="form-label">ì¹´í…Œê³ ë¦¬</label>
                            <select id="announcementCategory" class="form-input">
                                <option value="í–‰ì‚¬">í–‰ì‚¬</option>
                                <option value="ê¸°ë„íšŒ">ê¸°ë„íšŒ</option>
                                <option value="ëª¨ì„">ëª¨ì„</option>
                                <option value="ê³µì§€">ê³µì§€</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="form-group">
                            <label for="announcementIcon" class="form-label">ì•„ì´ì½˜</label>
                            <select id="announcementIcon" class="form-input">
                                <option value="heart">í•˜íŠ¸</option>
                                <option value="users">ì‚¬ëŒë“¤</option>
                                <option value="calendar">ë‹¬ë ¥</option>
                                <option value="bell">ì¢…</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="announcementDate" class="form-label">ë‚ ì§œ</label>
                    <input type="date" id="announcementDate" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <div class="d-flex align-items-center justify-content-between">
                        <label for="announcementImportant" class="form-label mb-0">ì¤‘ìš” ì†Œì‹</label>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="announcementImportant">
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="edit-dialog-footer">
                <button class="btn btn-outline" onclick="closeAnnouncementDialog()">ì·¨ì†Œ</button>
                <button class="btn btn-primary" onclick="saveAnnouncement()" id="saveAnnouncementBtn">ì¶”ê°€</button>
            </div>
        </div>
    </div>

    <!-- QR ëª¨ë‹¬ -->
    <div id="qrModal" class="modal" tabindex="-1" style="display: none;">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">ë””ì§€í„¸ ì£¼ë³´</h5>
                    <button type="button" class="btn-close" onclick="closeQRModal()"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center">
                        <h3 class="fw-semibold mb-1" style="color: var(--foreground);">ë””ì§€í„¸ ì£¼ë³´</h3>
                        <p class="mb-3" style="font-size: 0.875rem; color: var(--muted-foreground);">QR ì½”ë“œë¥¼ ìŠ¤ìº”í•˜ì—¬ ì˜¨ë¼ì¸ ì£¼ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”</p>
                        
                        <!-- QR ì½”ë“œ ì´ë¯¸ì§€ -->
                        <div class="mb-3" th:if="${qrCodeImage != null}">
                            <img th:src="'data:image/png;base64,' + ${qrCodeImage}" 
                                 alt="QR ì½”ë“œ" 
                                 class="img-fluid rounded shadow-sm" 
                                 style="max-width: 250px; margin: 0 auto;">
                        </div>
                        
                        <!-- QR ì½”ë“œê°€ ì—†ì„ ê²½ìš° ì•„ì´ì½˜ í‘œì‹œ -->
                        <div class="d-flex align-items-center justify-content-center rounded-2 mx-auto mb-3" 
                             th:if="${qrCodeImage == null}"
                             style="width: 4rem; height: 4rem; background: var(--primary); background-opacity: 0.1;">
                            <i class="fas fa-qrcode" style="font-size: 2rem; color: var(--primary);"></i>
                        </div>
                        
                        <!-- QR ì½”ë“œ ê³µìœ  ë²„íŠ¼ -->
                        <button class="btn btn-outline-primary btn-sm" onclick="shareQRCode()">
                            <i class="fas fa-share-alt me-1"></i> ì£¼ë³´ ê³µìœ í•˜ê¸°
                        </button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeQRModal()">ë‹«ê¸°</button>
                </div>
            </div>
        </div>
    </div>

    <style>
        /* QR ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1050;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-dialog {
            max-width: 500px;
            width: 95%;
            margin: 0;
        }

        .modal-content {
            border-radius: 12px;
            border: none;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            background: var(--background);
        }

        .modal-header {
            padding: 1.5rem 2rem 1rem 2rem;
            border-bottom: 1px solid var(--border);
            background: var(--background);
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--foreground);
            margin: 0;
        }

        .modal-body {
            padding: 2rem;
        }

        .modal-footer {
            padding: 1rem 2rem 2rem 2rem;
            border-top: 1px solid var(--border);
        }

        .btn-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--muted-foreground);
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-close::before {
            content: "Ã—";
        }

        .btn-close:hover {
            color: var(--foreground);
        }
        
        /* ìˆœëª¨ì„ íƒ­ ìŠ¤íƒ€ì¼ */
        #smallGroupsTab {
            position: relative;
            z-index: 1;
        }
        
        /* í—¤ë”ì™€ ë„¤ë¹„ê²Œì´ì…˜ë°”ê°€ í•­ìƒ ë³´ì´ë„ë¡ */
        .header {
            position: relative;
            z-index: 10;
        }
        
        .bottom-nav {
            position: fixed !important;
            bottom: 0 !important;
            left: 0 !important;
            right: 0 !important;
            z-index: 1000 !important;
        }
    </style>

    <!-- ë„¤ë¹„ê²Œì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ -->
    <th:block th:replace="~{fragments/bottom-nav :: navigation-scripts}"></th:block>
    <th:block th:replace="~{fragments/bulletin-viewer :: bulletin-scripts}"></th:block>
    
    <!-- í˜ì´ì§€ ê¸°ëŠ¥ ìŠ¤í¬ë¦½íŠ¸ -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // ì•„ì½”ë””ì–¸ í† ê¸€ í•¨ìˆ˜
        function toggleSection(contentId) {
            const content = document.getElementById(contentId);
            const icon = document.getElementById(contentId.replace('Content', 'Icon'));
            
            if (content.style.maxHeight === '0px' || content.style.maxHeight === '') {
                // ì—´ê¸°
                content.style.maxHeight = content.scrollHeight + 'px';
                content.style.opacity = '1';
                if (icon) icon.style.transform = 'rotate(180deg)';
            } else {
                // ë‹«ê¸°
                content.style.maxHeight = '0px';
                content.style.opacity = '0';
                if (icon) icon.style.transform = 'rotate(0deg)';
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ëª¨ë“  ì„¹ì…˜ì„ ë‹«íŒ ìƒíƒœë¡œ ì„¤ì •
        document.addEventListener('DOMContentLoaded', function() {
            const accordionContents = document.querySelectorAll('.accordion-content');
            accordionContents.forEach(content => {
                content.style.maxHeight = '0px';
                content.style.opacity = '0';
            });
        });
        
        // ì†Œì‹ ê´€ë¦¬ ê¸°ëŠ¥
        let currentEditingAnnouncementId = null;
        
        // ì†Œì‹ ìƒì„¸ë³´ê¸°
        async function viewAnnouncement(id) {
            try {
                const response = await fetch(`/api/announcements/${id}`);
                if (!response.ok) {
                    throw new Error('ì†Œì‹ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
                
                const announcement = await response.json();
                
                // ëª¨ë‹¬ì— ë°ì´í„° ì„¤ì •
                document.getElementById('viewAnnouncementTitle').textContent = announcement.title;
                document.getElementById('viewAnnouncementContent').textContent = announcement.content;
                document.getElementById('viewAnnouncementDate').textContent = announcement.announcementDate;
                
                // ì¤‘ìš”ë„ í‘œì‹œ
                const importantBadge = document.getElementById('viewAnnouncementImportant');
                if (announcement.isImportant) {
                    importantBadge.style.display = 'inline-block';
                } else {
                    importantBadge.style.display = 'none';
                }
                
                document.getElementById('announcementViewDialog').style.display = 'flex';
                
            } catch (error) {
                console.error('ì†Œì‹ ì¡°íšŒ ì‹¤íŒ¨:', error);
                alert('ì†Œì‹ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        function closeAnnouncementViewDialog() {
            document.getElementById('announcementViewDialog').style.display = 'none';
        }
        
        function openAddAnnouncementDialog() {
            currentEditingAnnouncementId = null;
            document.getElementById('announcementDialogTitle').textContent = 'ì†Œì‹ ì¶”ê°€';
            document.getElementById('saveAnnouncementBtn').textContent = 'ì¶”ê°€';
            
            // í¼ ì´ˆê¸°í™”
            document.getElementById('announcementTitle').value = '';
            document.getElementById('announcementContent').value = '';
            document.getElementById('announcementCategory').value = 'í–‰ì‚¬';
            document.getElementById('announcementIcon').value = 'heart';
            document.getElementById('announcementDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('announcementImportant').checked = false;
            
            document.getElementById('announcementDialog').style.display = 'flex';
        }
        
        async function openEditAnnouncementDialog(id) {
            try {
                const response = await fetch(`/api/announcements/${id}`);
                if (!response.ok) {
                    throw new Error('ì†Œì‹ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
                
                const announcement = await response.json();
                
                currentEditingAnnouncementId = id;
                document.getElementById('announcementDialogTitle').textContent = 'ì†Œì‹ ìˆ˜ì •';
                document.getElementById('saveAnnouncementBtn').textContent = 'ìˆ˜ì •';
                
                // í¼ì— ê¸°ì¡´ ë°ì´í„° ì„¤ì •
                document.getElementById('announcementTitle').value = announcement.title;
                document.getElementById('announcementContent').value = announcement.content;
                document.getElementById('announcementDate').value = announcement.announcementDate;
                document.getElementById('announcementImportant').checked = announcement.isImportant;
                
                document.getElementById('announcementDialog').style.display = 'flex';
                
            } catch (error) {
                console.error('ì†Œì‹ ì¡°íšŒ ì‹¤íŒ¨:', error);
                alert('ì†Œì‹ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        function closeAnnouncementDialog() {
            document.getElementById('announcementDialog').style.display = 'none';
        }
        
        async function saveAnnouncement() {
            const title = document.getElementById('announcementTitle').value;
            const content = document.getElementById('announcementContent').value;
            const date = document.getElementById('announcementDate').value;
            const important = document.getElementById('announcementImportant').checked;
            
            if (!title || !content) {
                alert('ì œëª©ê³¼ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            try {
                const announcementData = {
                    title: title,
                    content: content,
                    announcementDate: date,
                    isImportant: important,
                    isActive: true,
                    displayOrder: 0,
                    startDate: null,
                    endDate: null
                };
                
                let response;
                if (currentEditingAnnouncementId) {
                    // ìˆ˜ì •
                    response = await fetch(`/api/announcements/${currentEditingAnnouncementId}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(announcementData)
                    });
                } else {
                    // ì¶”ê°€
                    response = await fetch('/api/announcements', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(announcementData)
                    });
                }
                
                if (!response.ok) {
                    throw new Error('ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
                
                alert(currentEditingAnnouncementId ? 'ì†Œì‹ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!' : 'ì†Œì‹ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!');
                closeAnnouncementDialog();
                
                // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
                setTimeout(() => {
                    location.reload();
                }, 1000);
                
            } catch (error) {
                console.error('ì†Œì‹ ì €ì¥ ì‹¤íŒ¨:', error);
                alert('ì†Œì‹ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        async function deleteAnnouncement(id) {
            if (confirm('ì´ ì†Œì‹ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                try {
                    const response = await fetch(`/api/announcements/${id}`, {
                        method: 'DELETE'
                    });
                    
                    if (!response.ok) {
                        throw new Error('ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }
                    
                    alert('ì†Œì‹ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!');
                    
                    // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
                    setTimeout(() => {
                        location.reload();
                    }, 1000);
                    
                } catch (error) {
                    console.error('ì†Œì‹ ì‚­ì œ ì‹¤íŒ¨:', error);
                    alert('ì†Œì‹ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            }
        }
    </script>
</body>
</html>
